<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>stlite app</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@stlite/mountable@0.52.1/build/stlite.css"
    />
  </head>
  <body>
    <div id="root"></div>
    <script src="https://cdn.jsdelivr.net/npm/@stlite/mountable@0.52.1/build/stlite.js"></script>
    <script>
stlite.mount(
  {
    requirements: ["pandas", "openpyxl"],
    entrypoint: "streamlit_app.py",
    files: {
"streamlit_app.py": `import streamlit as st
import pandas as pd
import re

menu_items = {
	'About': '''
	 ## Mi primera app
	 Esta aplicacion fue desarrollada durante mi periodo de practicas en la Sala Colegiada del Osinergmin. Para cualquier comunicaci√≥n, escribir al correo: junior19a2000@gmail.com
	'''
}

st.set_page_config(page_title = 'SearchIT App', 
                   page_icon = 'ü§ñ', 
                   layout = "centered", 
                   initial_sidebar_state = "expanded",
                   menu_items = menu_items)

@st.cache_data(ttl = 24*3600)
def cargando_informacion_espere_porfavor():
    data_id2015I1 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1l01IifKKhsEhRJS2U-sx-cDudf0CUPc5/export?format=xlsx")).fillna('No existe o No se encontro coincidencias')
    data_id2015I2 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/10WT3qqOPsS8FsPQRDcoKPodScrEe0ALJ/export?format=xlsx"))
    data_id2016I1 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1jQo2Boxb2N_OGmZBNZBD4ClanbSjVu90/export?format=xlsx")).fillna('No existe o No se encontro coincidencias')
    data_id2016I2 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/15Ojutw0wsEsKjjpj20P5k_AUMdR0PIpQ/export?format=xlsx"))
    data_id2017I1 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1xYwrCA-8UXoJ7GIrjMzVVNoZ9XSaR12f/export?format=xlsx")).fillna('No existe o No se encontro coincidencias')
    data_id2017I2 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1gqtAXQkjOWPKXdqHLk4OhbI9-_FvVEm6/export?format=xlsx"))
    data_id2018_1 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1aeJsN9F2fVvMqjOpW6Dg0oEu3ikZO_bQ/export?format=xlsx"))
    data_id2018_2 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/186yP5vnIn0LlFNfho-1VyNgdjumwtR-0/export?format=xlsx"))
    data_id2018I1 = pd.concat([data_id2018_1, data_id2018_2], ignore_index = True).fillna('No existe o No se encontro coincidencias')
    data_id2018I2 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1G-C5_I7lu-zgcsmU2qPtYap2sY0A1c2H/export?format=xlsx"))
    data_id2019_1 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/19gui33n3q9KGDQI3tuqyneVytHQ8wbQQ/export?format=xlsx"))
    data_id2019_2 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1kqhKi2llnjQCOWAfDAAsXoC5X37xqX3z/export?format=xlsx"))
    data_id2019I1 = pd.concat([data_id2019_1, data_id2019_2], ignore_index = True).fillna('No existe o No se encontro coincidencias')
    data_id2019I2 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1O2QDKQ0eNmwdxpeAkn3XLvEUUsCbguXE/export?format=xlsx"))
    data_id2020I1 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1dhJP3ZRg1YNRZWHz9UulpCES2X8f46gG/export?format=xlsx")).fillna('No existe o No se encontro coincidencias')
    data_id2020I2 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1h5tkB1kdJkoeKJr7YZBQM-FjlHBX2euD/export?format=xlsx"))
    data_id2021_1 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1SfWEVqtsV3eRvjzmsT0Bo60JOnf2nmAn/export?format=xlsx"))
    data_id2021_2 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1-nksJqpUewALMTgDSy2bTIrGOBrvpAzD/export?format=xlsx"))
    data_id2021I1 = pd.concat([data_id2021_1, data_id2021_2], ignore_index = True).fillna('No existe o No se encontro coincidencias')
    data_id2021I2 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1wbSSZVN2Sq03opbwnxIeUTb8bfwmHy3G/export?format=xlsx"))
    data_id2022I1 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1H0irzXgs5Fiig45EPTHPwQi6y6XZXuIZ/export?format=xlsx")).fillna('No existe o No se encontro coincidencias')
    data_id2022I2 = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1TQ4EaGcr_mDxsOiNJGWaB1Rt2ZOucRZg/export?format=xlsx"))
    data_usuarios = pd.read_excel(pd.ExcelFile(f"https://docs.google.com/spreadsheets/d/1hQauRy8B1FdZMRKYdG4yzi0tAbI2y7iA/export?format=xlsx")).fillna('No existe o No se encontro coincidencias')
    return data_id2015I1, data_id2015I2, data_id2016I1, data_id2016I2, data_id2017I1, data_id2017I2, data_id2018I1, data_id2018I2, \\
           data_id2019I1, data_id2019I2, data_id2020I1, data_id2020I2, data_id2021I1, data_id2021I2, data_id2022I1, data_id2022I2, \\
           data_usuarios
data_id2015I1, data_id2015I2, data_id2016I1, data_id2016I2, data_id2017I1, data_id2017I2, data_id2018I1, data_id2018I2, data_id2019I1, data_id2019I2, data_id2020I1, data_id2020I2, data_id2021I1, data_id2021I2, data_id2022I1, data_id2022I2, data_usuarios = cargando_informacion_espere_porfavor()

def valid(semilist):
    separ = re.findall('\\(.*?\\)', semilist)
    words = [[] for i in range(len(separ))]
    j     = -1
    for i in separ:
        j = j + 1
        if len(i.replace('(', '').replace(')', '').split(',')) == 1:
            words[j] = i.replace('(', '').replace(')', '')
        else:
            for k in i.replace('(', '').replace(')', '').replace(' ', '').split(','):
                words[j].append(k)
    return words

def searchwords(text, keys):
    words = valid(keys)
    tandf = [''] * len(words)
    j     = -1
    for i in words:
        j = j + 1
        if isinstance(words[j], list):
            torf = [''] * len(words[j])
            n    = -1
            for k in words[j]:
                n = n + 1
                if k[0] == '-':
                    k = k.replace('-', '')
                    if k not in text:
                        torf[n] = 1
                    else:
                        torf[n] = 0
                else:
                    if k in text:
                        torf[n] = 1
                    else:
                        torf[n] = 0
            if 1 in torf:
                tandf[j] = 1
            else:
                tandf[j] = 0
        else:
            if i[0] == '-':
                i = i.replace('-', '')
                if i not in text:
                    tandf[j] = 1
                else:
                    tandf[j] = 0
            else:
                if i in text:
                    tandf[j] = 1
                else:
                    tandf[j] = 0
    if 0 in tandf:
        rpt = 0
    else:
        rpt = 1
    return rpt

def showdoc(value, year):
    naexp = value
    idexp = '1As_Rcolpc8s3YzTOolXisjJY9HQvC22H'
    if year == '2015':
        for i in range(data_id2015I2.shape[0]):
            if naexp in data_id2015I2.iat[i,0]:
                idexp = data_id2015I2.iat[i,1]
                break
    elif year == '2016':
        for i in range(data_id2016I2.shape[0]):
            if naexp in data_id2016I2.iat[i,0]:
                idexp = data_id2016I2.iat[i,1]
                break
    elif year == '2017':
        for i in range(data_id2017I2.shape[0]):
            if naexp in data_id2017I2.iat[i,0]:
                idexp = data_id2017I2.iat[i,1]
                break
    elif year == '2018':
        for i in range(data_id2018I2.shape[0]):
            if naexp in data_id2018I2.iat[i,0]:
                idexp = data_id2018I2.iat[i,1]
                break
    elif year == '2019':
        for i in range(data_id2019I2.shape[0]):
            if naexp in data_id2019I2.iat[i,0]:
                idexp = data_id2019I2.iat[i,1]
                break
    elif year == '2020':
        for i in range(data_id2020I2.shape[0]):
            if naexp in data_id2020I2.iat[i,0]:
                idexp = data_id2020I2.iat[i,1]
                break
    elif year == '2021':
        for i in range(data_id2021I2.shape[0]):
            if naexp in data_id2021I2.iat[i,0]:
                idexp = data_id2021I2.iat[i,1]
                break
    elif year == '2022':
        for i in range(data_id2022I2.shape[0]):
            if naexp in data_id2022I2.iat[i,0]:
                idexp = data_id2022I2.iat[i,1]
                break
    url   = "https://drive.google.com/file/d/" + idexp + "/preview"
    st.markdown(f'<iframe src={url} height="600px" width="100%" style="border:0px solid black"></iframe>', unsafe_allow_html = True)

def findexp(value1, value2, value3, value4, value5, value6, year):
    empty1.progress(0.0, text = None)
    areas = [''] * 6
    areas[0] = value1; areas[1] = value2; areas[2] = value3
    areas[3] = value4; areas[4] = value5; areas[5] = value6
    namebox  = ['Concesionaria', 'Materia', 'Sumilla', 'Antecedentes', 'Analisis', 'Resoluci√≥n']
    key      = 1
    numerbox = -1
    for area in areas:
        if len(area.replace(' ', '')) != 0:
            key = 1
            break
        key = 0
    if key == 0:
        st.toast('No hay que buscar !')
    if key != 0:
        for area in areas:
            numerbox = numerbox + 1
            if area.replace(' ', '') != '':
                if len(valid(area)) == 0:
                    key = 0
                    st.toast('Revise lo registrado en ' + namebox[numerbox])
                    break
    if key != 0:
        extract  = []
        st.toast('La busqueda ha iniciado !')
        if year == '2015':
            max_value = data_id2015I2.shape[0]
            for i in range(max_value):
                expediente = data_id2015I1.iat[i,0]; concesionaria = data_id2015I1.iat[i,1]; materia = data_id2015I1.iat[i,2]
                sumilla = data_id2015I1.iat[i,3]; vistos = data_id2015I1.iat[i,4]; analisis = data_id2015I1.iat[i,5]; resolucion = data_id2015I1.iat[i,6]
                infor = [concesionaria, materia, sumilla, vistos, analisis, resolucion]
                k     = -1
                for area in areas:
                    k = k + 1
                    if area.replace(' ', '') != '':
                        if searchwords(infor[k], area) == 0:
                            break
                    if k == (len(infor) - 1):
                        extract.append([expediente, concesionaria, materia, sumilla])
                empty1.progress(float(i / max_value), text = None)
        elif year == '2016':
            max_value = data_id2016I2.shape[0]
            for i in range(max_value):
                expediente = data_id2016I1.iat[i,0]; concesionaria = data_id2016I1.iat[i,1]; materia = data_id2016I1.iat[i,2]
                sumilla = data_id2016I1.iat[i,3]; vistos = data_id2016I1.iat[i,4]; analisis = data_id2016I1.iat[i,5]; resolucion = data_id2016I1.iat[i,6]
                infor = [concesionaria, materia, sumilla, vistos, analisis, resolucion]
                k     = -1
                for area in areas:
                    k = k + 1
                    if area.replace(' ', '') != '':
                        if searchwords(infor[k], area) == 0:
                            break
                    if k == (len(infor) - 1):
                        extract.append([expediente, concesionaria, materia, sumilla])
                empty1.progress(float(i / max_value), text = None)
        elif year == '2017':
            max_value = data_id2017I2.shape[0]
            for i in range(max_value):
                expediente = data_id2017I1.iat[i,0]; concesionaria = data_id2017I1.iat[i,1]; materia = data_id2017I1.iat[i,2]
                sumilla = data_id2017I1.iat[i,3]; vistos = data_id2017I1.iat[i,4]; analisis = data_id2017I1.iat[i,5]; resolucion = data_id2017I1.iat[i,6]
                infor = [concesionaria, materia, sumilla, vistos, analisis, resolucion]
                k     = -1
                for area in areas:
                    k = k + 1
                    if area.replace(' ', '') != '':
                        if searchwords(infor[k], area) == 0:
                            break
                    if k == (len(infor) - 1):
                        extract.append([expediente, concesionaria, materia, sumilla])
                empty1.progress(float(i / max_value), text = None)
        elif year == '2018':
            max_value = data_id2018I2.shape[0]
            for i in range(max_value):
                expediente = data_id2018I1.iat[i,0]; concesionaria = data_id2018I1.iat[i,1]; materia = data_id2018I1.iat[i,2]
                sumilla = data_id2018I1.iat[i,3]; vistos = data_id2018I1.iat[i,4]; analisis = data_id2018I1.iat[i,5]; resolucion = data_id2018I1.iat[i,6]
                infor = [concesionaria, materia, sumilla, vistos, analisis, resolucion]
                k     = -1
                for area in areas:
                    k = k + 1
                    if area.replace(' ', '') != '':
                        if searchwords(infor[k], area) == 0:
                            break
                    if k == (len(infor) - 1):
                        extract.append([expediente, concesionaria, materia, sumilla])
                empty1.progress(float(i / max_value), text = None)
        elif year == '2019':
            max_value = data_id2019I2.shape[0]
            for i in range(max_value):
                expediente = data_id2019I1.iat[i,0]; concesionaria = data_id2019I1.iat[i,1]; materia = data_id2019I1.iat[i,2]
                sumilla = data_id2019I1.iat[i,3]; vistos = data_id2019I1.iat[i,4]; analisis = data_id2019I1.iat[i,5]; resolucion = data_id2019I1.iat[i,6]
                infor = [concesionaria, materia, sumilla, vistos, analisis, resolucion]
                k     = -1
                for area in areas:
                    k = k + 1
                    if area.replace(' ', '') != '':
                        if searchwords(infor[k], area) == 0:
                            break
                    if k == (len(infor) - 1):
                        extract.append([expediente, concesionaria, materia, sumilla])
                empty1.progress(float(i / max_value), text = None)
        elif year == '2020':
            max_value = data_id2020I2.shape[0]
            for i in range(max_value):
                expediente = data_id2020I1.iat[i,0]; concesionaria = data_id2020I1.iat[i,1]; materia = data_id2020I1.iat[i,2]
                sumilla = data_id2020I1.iat[i,3]; vistos = data_id2020I1.iat[i,4]; analisis = data_id2020I1.iat[i,5]; resolucion = data_id2020I1.iat[i,6]
                infor = [concesionaria, materia, sumilla, vistos, analisis, resolucion]
                k     = -1
                for area in areas:
                    k = k + 1
                    if area.replace(' ', '') != '':
                        if searchwords(infor[k], area) == 0:
                            break
                    if k == (len(infor) - 1):
                        extract.append([expediente, concesionaria, materia, sumilla])
                empty1.progress(float(i / max_value), text = None)
        elif year == '2021':
            max_value = data_id2021I2.shape[0]
            for i in range(max_value):
                expediente = data_id2021I1.iat[i,0]; concesionaria = data_id2021I1.iat[i,1]; materia = data_id2021I1.iat[i,2]
                sumilla = data_id2021I1.iat[i,3]; vistos = data_id2021I1.iat[i,4]; analisis = data_id2021I1.iat[i,5]; resolucion = data_id2021I1.iat[i,6]
                infor = [concesionaria, materia, sumilla, vistos, analisis, resolucion]
                k     = -1
                for area in areas:
                    k = k + 1
                    if area.replace(' ', '') != '':
                        if searchwords(infor[k], area) == 0:
                            break
                    if k == (len(infor) - 1):
                        extract.append([expediente, concesionaria, materia, sumilla])
                empty1.progress(float(i / max_value), text = None)
        elif year == '2022':
            max_value = data_id2022I2.shape[0]
            for i in range(max_value):
                expediente = data_id2022I1.iat[i,0]; concesionaria = data_id2022I1.iat[i,1]; materia = data_id2022I1.iat[i,2]
                sumilla = data_id2022I1.iat[i,3]; vistos = data_id2022I1.iat[i,4]; analisis = data_id2022I1.iat[i,5]; resolucion = data_id2022I1.iat[i,6]
                infor = [concesionaria, materia, sumilla, vistos, analisis, resolucion]
                k     = -1
                for area in areas:
                    k = k + 1
                    if area.replace(' ', '') != '':
                        if searchwords(infor[k], area) == 0:
                            break
                    if k == (len(infor) - 1):
                        extract.append([expediente, concesionaria, materia, sumilla])
                empty1.progress(float(i / max_value), text = None)
        if extract == []:
            extract.append(['NO', 'SE', 'ENCONTRARON', 'RESULTADOS'])
        df = pd.DataFrame(extract)
        df.columns = ['Expediente', 'Concesionaria', 'Materia', 'Sumilla']
        st.dataframe(df, use_container_width = True, hide_index = True)
        st.toast('La busqueda ha finalizado !')

with st.sidebar:
    text_input1 = st.text_input(label = 'Usuario')
    text_input2 = st.text_input(label = 'Contrase√±a',  type = 'password')
    st.divider()
    selectbox1 = st.selectbox('Seleccione el a√±o de analisis: ', ('2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022'), label_visibility = 'visible', key = 0)
    # st.image('Logo.png', use_column_width = True)
    st.markdown('<marquee style="font-size: 2; width: 100%" scrollamount="10"><b>Desarrollado por: Junior Aguilar</b></marquee>', unsafe_allow_html = True)

if 'key1' not in st.session_state:
    st.session_state.key1 = 1
empty2 = st.empty()
empty2.header(':rainbow[SearchIT 2.0]', divider = 'rainbow')
st.caption('Aplicativo para la busqueda de expedientes relacionados ...')
if text_input2 == 'OsinergminSC': 
    if st.session_state.key1 == 1:
        st.balloons()   
        st.session_state.key1 = 0
    empty2.header(f':rainbow[SearchIT 2.0... {text_input1}]' + 'üëã', divider = 'rainbow')
    with st.form('form1', border = False):
        col1, col2 = st.columns([1, 4], gap = 'small')
        with col1:
            st.write('#####')
            st.text('Concesionaria')
            st.write('#####')
            st.text('Materia')
            st.write('#####')
            st.text('Sumilla')
            st.write('#####')
            st.text('Antecedentes')
            st.write('#####')
            st.text('An√°lisis')
            st.write('#####')
            st.text('Resoluci√≥n')
        with col2:
            text_input3 = st.text_input(label = 'Concesionaria', label_visibility = 'collapsed', key = 1)
            text_input4 = st.text_input(label = 'Materia', label_visibility = 'collapsed', key = 2)
            text_input5 = st.text_input(label = 'Sumilla', label_visibility = 'collapsed', key = 3)
            text_input6 = st.text_input(label = 'Antecedentes', label_visibility = 'collapsed', key = 4)
            text_input7 = st.text_input(label = 'An√°lisis', label_visibility = 'collapsed', key = 5)
            text_input8 = st.text_input(label = 'Resoluci√≥n', label_visibility = 'collapsed', key = 6)
        bsubmitted1 = st.form_submit_button(label = 'Buscar expedientes relacionados', use_container_width = True)
        if bsubmitted1:
            empty1 = st.empty()
            findexp(text_input3, text_input4, text_input5, text_input6, text_input7, text_input8, selectbox1)

    st.divider()

    with st.form('form2', border = False):
        col3, col4 = st.columns([1, 1], gap = 'small')
        with col3:
            st.text('N√∫mero del expediente a visualizar')
        with col4:
            text_input9 = st.text_input(label = 'Expediente', label_visibility = 'collapsed', key = 7)
        bsubmitted2 = st.form_submit_button(label = 'Mostrar expediente', use_container_width = True)
        if bsubmitted2:
            showdoc(text_input9, selectbox1)
else:
    st.session_state.key1 = 1`,

},
  },
  document.getElementById("root")
)

    </script>
  </body>
  <!-- Generated from stlite sharing (https://edit.share.stlite.net/), and the source version is 8b72571ae0233544f6223a3cd848f08629ed0336 -->
</html>
